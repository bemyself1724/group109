# 使用 SM2 实现 PGP 方案

# 运行方式
* 直接运行文件PGP.py

## 1.PGP介绍

PGP采用公钥密码学与对称密钥相结合，用于保护电子邮件通信、文件和其他数据。其工作原理如下：

* 密钥生成：PGP使用公钥密码学。每个用户生成一对密码学密钥：公钥和私钥。公钥是公开共享的，用于加密和验证数字签名，而私钥是保密的，用于解密和创建数字签名。

* 加密：当用户想要向另一个用户发送加密消息时，他们使用对称会话密钥对消息进行加密，再使用消息接收者的公钥对对称会话密钥加密。加密后，只有拥有相应私钥的接收者可以解密会话密钥并进一步阅读消息。这种方式既可以保护数据的安全性，也可以提高加解密的速度。

* 信任网络：PGP采用去中心化的信任模型，称为“信任网络”。用户可以签署彼此的公钥以建立信任。通过签署他人的公钥，用户为该密钥的真实性提供了背书。密钥获得的签名越多，与之相关的信任级别就越高。

其中最关键的是两种形式的加密的组合：对称密钥加密和非对称密钥加密,如下所示：

![](https://pic.imgdb.cn/item/64cced481ddac507ccfd4b0b.jpg)


## 2.SM2算法

SM2算法大体分为密钥产生，密钥派生，加密，解密四部分。具体算法结构请参见project11



## 使用SM2算法与SM4算法体系实现PGP

## 实现思路：
* 发送方加密：
1.发送端 和 接收端 分别生成sm2的公钥和私钥$(pk_send,sk_send),(pk_rec,sk_rec)$<br>
2.生成临时会话密钥 SK,这里的对称加密使用sm4<br>
3.加密sk：$encryptKey=Ecn_{pk_r}(Sk)$<br>
4.加密data：$encrypt=Ecn_{Sk}(data)$<br>

* 接收方解密：<br>
1.用sk_r解密encryptKey得到SK<br>
2.用sk解密得到data<ne>

## 运行结果

![](https://pic.imgdb.cn/item/64cd02081ddac507cc31efa6.jpg)


# 参考文献

[1] https://www.oscca.gov.cn/sca/xxgk/2010-12/17/1002386/files/b791a9f908bb4803875ab6aeeb7b4e03.pdf

[2] https://www.oscca.gov.cn/sca/xxgk/2010-12/17/1002386/files/b965ce832cc34bc191cb1cde446b860d.pdf

