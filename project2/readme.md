# <center> 实现简化SM3的Rho方法 </center>

## 运行方式
直接运行SM3_Rho.py即可，输入自选参数x进行前4x位Rho方法碰撞攻击，输入-1时程序结束。


## 1.SM3代码的实现
与生日攻击采取相同的代码实现，不再赘述。


## 2.Rho方法
Rho方法主要用于寻找离散对数问题中的循环节，特别是在对称密钥密码学中的一些攻击中有重要应用。方法的结构如下图所示：

![](https://pic.imgdb.cn/item/64ca82d71ddac507cc0d874b.jpg)


选择两个随机的起始点h1和h2(本代码中选择由同一起始点x迭代生成)，并选择一个随机的迭代函数，此处为SM3哈希函数。h1 = SM3(x) 和 h2 = SM3(SM3(x))。

Rho方法在每一步迭代中分别移动1步和2步，也就是h1 = SM3(h1)和h2 = SM3(SM3(h2))。然后，检测h1和h2是否相等，如果相等则认为找到了一个循环节。此时按照相同的步幅进行迭代，直到找到下一循环节则认为找到了一组碰撞。

由于SM3哈希函数不是基于离散对数问题，而是基于一系列位运算和非线性函数设计的，具有强抗碰撞性，因此我们选择简化的SM3算法进行Rho碰撞,即获得哈希值后只取前4x位进行碰撞.

Rho方法的成功性会受到哈希函数的碰撞性与初始值选择的影响，而SM3的抗碰撞性很高，因此当找到一组完整SM3的哈希值相等时则认为寻找碰撞失败，需重新选择初始值。



## 3.运行结果
本实验采用简化的SM3进行Rho碰撞，即获得哈希值后只取前4x位进行碰撞，x为自选参数。输入-1时程序结束。运行结果如图所示：

* 通过编写的SM3.py文件进行12bit Rho碰撞
  
![](https://pic.imgdb.cn/item/64ca819b1ddac507cc0aef26.jpg)

* 通过gmssl库提供的SM3哈希算法进行20bit Rho碰撞
  
![](https://pic.imgdb.cn/item/64ca7d961ddac507cc025081.jpg)
  
